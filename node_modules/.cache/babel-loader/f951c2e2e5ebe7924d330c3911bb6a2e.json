{"ast":null,"code":"import { all, call, put, takeLeading, takeEvery, select } from 'redux-saga/effects';\nimport { push, getLocation } from 'connected-react-router';\nimport * as AuthAPIs from '../../apis/auth';\nimport { actions as AuthActions, AUTH_REGISTER_USER, AUTH_LOGOUT } from '../../reducers/auth';\nexport function* userRegistration({\n  userData\n}) {\n  try {\n    const userResponseData = yield call(AuthAPIs.userRegister, userData);\n    const error = null;\n    if (error) throw error;\n    yield put(AuthActions.userRegisterSuccess(userResponseData));\n    yield put(AuthActions.loginSuccess());\n  } catch (error) {\n    yield put(AuthActions.userRegisterFailed(error));\n  }\n}\n\nfunction* handleStudentLogin({\n  loginValues\n}) {\n  try {\n    const email = loginValues.email,\n          password = loginValues.password;\n\n    const _ref = yield call(AuthAPIs.getStudentToken, email, password),\n          response = _ref.response,\n          error = _ref.error;\n\n    if (error) throw error;\n    const data = response.data;\n    const user = data.user,\n          tokens = data.tokens;\n    const token = tokens.access,\n          refreshToken = tokens.refresh;\n    configToken(token);\n    yield put(AuthActions.loginSuccess(token, refreshToken, user));\n  } catch (error) {\n    yield put(AuthActions.loginFailed(error));\n  }\n} // function* handleTeacherLogin({ payload }) {\n//   try {\n//     const { email, password } = payload;\n//     const { response, error } = yield call(AuthAPIs.getTeacherToken, email, password);\n//     if (error) throw error;\n//     const { data } = response;\n//     const { user, tokens } = data;\n//     const { access: token, refresh: refreshToken } = tokens;\n//     configToken(token);\n//     yield put(AuthActions.loginSuccess(token, refreshToken, user));\n//   } catch (error) {\n//     yield put(AuthActions.loginFailed(error));\n//   }\n// }\n\n\nfunction* handleLogout() {\n  const location = yield select(getLocation);\n  const pathname = location.pathname;\n\n  if (pathname !== '/login') {\n    yield put(push('/login'));\n  }\n}\n\nexport default function* authSaga() {\n  yield all([takeLeading(AUTH_REGISTER_USER, userRegistration), takeEvery(AUTH_LOGOUT, handleLogout)]);\n}","map":{"version":3,"sources":["/Users/mr942/Projects/mini-aspire/src/sagas/auth/authSaga.js"],"names":["all","call","put","takeLeading","takeEvery","select","push","getLocation","AuthAPIs","actions","AuthActions","AUTH_REGISTER_USER","AUTH_LOGOUT","userRegistration","userData","userResponseData","userRegister","error","userRegisterSuccess","loginSuccess","userRegisterFailed","handleStudentLogin","loginValues","email","password","getStudentToken","response","data","user","tokens","token","access","refreshToken","refresh","configToken","loginFailed","handleLogout","location","pathname","authSaga"],"mappings":"AAAA,SACEA,GADF,EACOC,IADP,EACaC,GADb,EAEEC,WAFF,EAGEC,SAHF,EAGaC,MAHb,QAIO,oBAJP;AAKA,SAASC,IAAT,EAAeC,WAAf,QAAkC,wBAAlC;AACA,OAAO,KAAKC,QAAZ,MAA0B,iBAA1B;AACA,SACEC,OAAO,IAAIC,WADb,EAEEC,kBAFF,EAGEC,WAHF,QAIO,qBAJP;AAMA,OAAO,UAAUC,gBAAV,CAA2B;AAAEC,EAAAA;AAAF,CAA3B,EAAyC;AAC9C,MAAI;AACF,UAAMC,gBAAgB,GAAG,MAAMd,IAAI,CAACO,QAAQ,CAACQ,YAAV,EAAwBF,QAAxB,CAAnC;AACA,UAAMG,KAAK,GAAG,IAAd;AAEA,QAAIA,KAAJ,EAAW,MAAMA,KAAN;AAEX,UAAMf,GAAG,CAACQ,WAAW,CAACQ,mBAAZ,CAAgCH,gBAAhC,CAAD,CAAT;AACA,UAAMb,GAAG,CAACQ,WAAW,CAACS,YAAZ,EAAD,CAAT;AACD,GARD,CAQE,OAAOF,KAAP,EAAc;AACd,UAAMf,GAAG,CAACQ,WAAW,CAACU,kBAAZ,CAA+BH,KAA/B,CAAD,CAAT;AACD;AACF;;AAED,UAAUI,kBAAV,CAA6B;AAAEC,EAAAA;AAAF,CAA7B,EAA8C;AAC5C,MAAI;AAAA,UACMC,KADN,GAC0BD,WAD1B,CACMC,KADN;AAAA,UACaC,QADb,GAC0BF,WAD1B,CACaE,QADb;;AAAA,iBAE0B,MAAMvB,IAAI,CAACO,QAAQ,CAACiB,eAAV,EAA2BF,KAA3B,EAAkCC,QAAlC,CAFpC;AAAA,UAEME,QAFN,QAEMA,QAFN;AAAA,UAEgBT,KAFhB,QAEgBA,KAFhB;;AAIF,QAAIA,KAAJ,EAAW,MAAMA,KAAN;AAJT,UAMMU,IANN,GAMeD,QANf,CAMMC,IANN;AAAA,UAOMC,IAPN,GAOuBD,IAPvB,CAOMC,IAPN;AAAA,UAOYC,MAPZ,GAOuBF,IAPvB,CAOYE,MAPZ;AAAA,UAQcC,KARd,GAQ+CD,MAR/C,CAQME,MARN;AAAA,UAQ8BC,YAR9B,GAQ+CH,MAR/C,CAQqBI,OARrB;AAUFC,IAAAA,WAAW,CAACJ,KAAD,CAAX;AACA,UAAM5B,GAAG,CAACQ,WAAW,CAACS,YAAZ,CAAyBW,KAAzB,EAAgCE,YAAhC,EAA8CJ,IAA9C,CAAD,CAAT;AACD,GAZD,CAYE,OAAOX,KAAP,EAAc;AACd,UAAMf,GAAG,CAACQ,WAAW,CAACyB,WAAZ,CAAwBlB,KAAxB,CAAD,CAAT;AACD;AACF,C,CAED;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAEA,UAAUmB,YAAV,GAAyB;AACvB,QAAMC,QAAQ,GAAG,MAAMhC,MAAM,CAACE,WAAD,CAA7B;AADuB,QAEf+B,QAFe,GAEFD,QAFE,CAEfC,QAFe;;AAIvB,MAAIA,QAAQ,KAAK,QAAjB,EAA2B;AACzB,UAAMpC,GAAG,CAACI,IAAI,CAAC,QAAD,CAAL,CAAT;AACD;AACF;;AAED,eAAe,UAAUiC,QAAV,GAAqB;AAClC,QAAMvC,GAAG,CAAC,CACRG,WAAW,CAACQ,kBAAD,EAAqBE,gBAArB,CADH,EAERT,SAAS,CAACQ,WAAD,EAAcwB,YAAd,CAFD,CAAD,CAAT;AAID","sourcesContent":["import {\n  all, call, put,\n  takeLeading,\n  takeEvery, select,\n} from 'redux-saga/effects';\nimport { push, getLocation } from 'connected-react-router';\nimport * as AuthAPIs from '../../apis/auth';\nimport {\n  actions as AuthActions,\n  AUTH_REGISTER_USER,\n  AUTH_LOGOUT,\n} from '../../reducers/auth';\n\nexport function* userRegistration({ userData }) {\n  try {\n    const userResponseData = yield call(AuthAPIs.userRegister, userData);\n    const error = null;\n    \n    if (error) throw error;\n\n    yield put(AuthActions.userRegisterSuccess(userResponseData));\n    yield put(AuthActions.loginSuccess());\n  } catch (error) {\n    yield put(AuthActions.userRegisterFailed(error));\n  }\n}\n\nfunction* handleStudentLogin({ loginValues }) {\n  try {\n    const { email, password } = loginValues;\n    const { response, error } = yield call(AuthAPIs.getStudentToken, email, password);\n\n    if (error) throw error;\n\n    const { data } = response;\n    const { user, tokens } = data;\n    const { access: token, refresh: refreshToken } = tokens;\n\n    configToken(token);\n    yield put(AuthActions.loginSuccess(token, refreshToken, user));\n  } catch (error) {\n    yield put(AuthActions.loginFailed(error));\n  }\n}\n\n// function* handleTeacherLogin({ payload }) {\n//   try {\n//     const { email, password } = payload;\n//     const { response, error } = yield call(AuthAPIs.getTeacherToken, email, password);\n\n//     if (error) throw error;\n\n//     const { data } = response;\n//     const { user, tokens } = data;\n//     const { access: token, refresh: refreshToken } = tokens;\n\n//     configToken(token);\n//     yield put(AuthActions.loginSuccess(token, refreshToken, user));\n//   } catch (error) {\n//     yield put(AuthActions.loginFailed(error));\n//   }\n// }\n\nfunction* handleLogout() {\n  const location = yield select(getLocation);\n  const { pathname } = location;\n\n  if (pathname !== '/login') {\n    yield put(push('/login'));\n  }\n}\n\nexport default function* authSaga() {\n  yield all([\n    takeLeading(AUTH_REGISTER_USER, userRegistration),\n    takeEvery(AUTH_LOGOUT, handleLogout),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}